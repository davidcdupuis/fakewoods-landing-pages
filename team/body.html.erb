<% topic_list(list_opts: { order: 'views', category: 171, definitions_only: true, filter_categories: [171, 129] }, opts: { instance_var: "plugins", group_name: 'members' }) %>
<% topic_list(list_opts: { order: 'views', category: 129, no_definitions: true }, opts: { instance_var: "themes", group_name: 'members' }) %>
<% topic_list(list_opts: { order: 'views', category: 195, no_definitions: true }, opts: { instance_var: "discord", group_name: 'members' }) %>
<% topic_list(list_opts: { order: 'views', category: 198, no_definitions: true }, opts: { instance_var: "auth0", group_name: 'members' }) %>
<% topic_list(list_opts: { order: 'views', category: 199, no_definitions: true }, opts: { instance_var: "shopify", group_name: 'members' }) %>
<% topic_list(list_opts: { order: 'views', category: 194, no_definitions: true }, opts: { instance_var: "wordpress", group_name: 'members' }) %>

<header class="landing-header" style="display:block;">
  <div class="contents">
    <div class="primary">
      <div class="header-title">
        <a href="<%= path local_assigns[:root] || "/welcome" %>">
          <%- if local_assigns[:logo_url] || application_logo_url.present? %>
            <img src="<%= local_assigns[:logo_url] || application_logo_url %>" alt="<%= local_assigns[:title] || SiteSetting.title %>" id="site-logo">
          <%- else %>
            <h2 id='site-text-logo'><%= local_assigns[:title] || SiteSetting.title %></h2>
          <%- end %>
        </a>
      </div>
      <% unless mobile_view? %>
        <%- if @menu.present? %>
          <%= render partial: "menu" %>
        <%- end %>
      <% end %>
    </div>
    <% unless mobile_view? %>
      <%- if local_assigns[:notice].present? %>
        <a class="notice" href="<%= local_assigns[:notice][:href] %>">
          <label class="highlight"><%= local_assigns[:notice][:text] %></label>
        </a>
      <%- end %>
    <% end %>
    <div class="panel">
      <span class='header-buttons'>
        <% if mobile_view? %>
          <a class="mobile-toggle">
            <span class="menu-icon"><%= SvgSprite.raw_svg('bars') %></span>
            <span class="hide-menu-icon"><%= SvgSprite.raw_svg('times') %></span>
          </a>
        <% else %>
          <%- if current_user %>
            <a href="<%= path "/"%>" target="_blank" class='btn btn-primary forum-button'>
              Accéder au Canal
            </a>
          <% else %>
            <a href="<%= path "/login"%>" target="_blank" class='btn btn-primary login-button'>
              Créer un compte
            </a>
          <%- end %>
        <% end %>
      </span>
    </div>
  </div>
</header>

<% if mobile_view? %>
  <%- if @menu.present? %>
    <div class="mobile-header">
      <%= render partial: "menu" %>
    </div>
  <%- end %>
<% end %>

<div class="landing page">
  <div id="member-list" class="section anchor-buffer">
    <div class="title">
      <h1 title="Our Members">Notre équipe</h1>
    </div>
    <ul class="item-list">
      <% user_list(group_name: 'members', order: "random() ASC").each do |user| %>
        <li class="item <%= user.groups.where(name: ['developers', 'designers', 'project_managers', 'board']).map{ |g| g.name.downcase.dasherize }.join(' ') %>">
          <div class="user-details-container">
            <%= user_profile(
              user,
              avatar_size: 120,
              show_groups: ['developers', 'designers', 'project_managers', 'board'],
              add_bio: true,
              top_extra: "<ul class='user-links'>
                <li><a class='btn btn-icon' href='#{Discourse.base_url}/new-message?username=#{user.username}'>#{SvgSprite.raw_svg('envelope')}</a></li>
                <li><a class='btn btn-icon' href='https://github.com/#{user.user_associated_accounts.where("provider_name = 'github'").select("info->'nickname' as nickname").first.try(:nickname)}'>#{SvgSprite.raw_svg('fab-github')}</a></li>
                <li><a class='btn btn-icon' href='https://meta.discourse.org/u/#{user.user_fields["4"].present? ? user.user_fields["4"] : user.username}'>#{SvgSprite.raw_svg('fab-discourse')}</a></li>
              </ul>".strip
            ) %>
          </div>
          <div class="user-topic-lists">
            <% if (@plugins + @themes + @discord + @auth0 + @wordpress + @shopify).select { |t| t.user_id == user.id }.any? %>
              <div class="user-topic-list">
                <ul class="user-customisations">
                  <% (@plugins + @themes + @discord + @auth0 + @wordpress + @shopify).select { |t| t.user_id == user.id }[0..6].each do |t| %>
                    <li><%= link_to emoji_codes_to_img(t.fancy_title), t.relative_url %></li>
                  <% end %>
                </ul>
              </div>
            <% end %>
          </div>
        </li>
      <% end %>
    </ul>
  </div>
</div>
